# План тестирования (самохост devframework)

## 1) Цели
- Проверить, что devframework может провести интервью, сгенерировать артефакты и выполнить main→post прогон без ошибок.
- Убедиться, что секреты не утекают в логи/отчёты.
- Проверить готовность к типовым хост‑репо (пустой, legacy).

## 2) Область охвата
- Orchestrator CLI и конфиг (`orchestrator.py`, `orchestrator.json`).
- Discovery поток и генерация файлов (`docs/discovery/interview.md`, generated docs).
- Инструменты экспорта/публикации отчётов (`tools/export-report.py`, `tools/publish-report.py`).
- Framework-review поток (post phase).

## 3) Типы тестов
- Unit: разбор конфигурации, worktree path validation, lock handling, redact-функции, YAML/JSON I/O.
- Integration: no‑op прогон main; export-report на синтетических логах; publish-report dry-run.
- E2E: установка через `install-framework.sh` в пустой репо; запуск main→post в no‑op; запуск legacy анализа (read-only).
- Manual/UX: проверка понятности сгенерированных артефактов для не‑тех пользователя.

## 4) Критические сценарии
1) Установка в пустой репо → main no‑op → генерируются артефакты, нет ошибок.
2) Запуск legacy-фазы в репо с произвольными файлами → создаются migration артефакты, код не меняется.
3) Export + redact → в отчёте отсутствуют секреты, присутствуют ключевые логи.
4) Framework post‑run review → генерируются `framework-review/*` без падений.

## 5) Негативные кейсы
- Несуществующие worktree пути / занятые пути → корректная ошибка, без порчи репо.
- Отсутствие git → понятное сообщение, graceful exit.
- Нет PyYAML / зависимостей → сообщение с инструкцией.
- Пустой или повреждённый orchestrator config → валидационная ошибка.
- Отсутствуют креды при попытке реального деплоя → стоп‑точка, без утечек секретов.

## 6) Критерии приемки
- Все критические сценарии проходят; нет P0/P1.
- Логи без секретов; экспорт/публикация не раскрывают токены.
- Main→post no‑op завершается успешно и повторяемо.

## 7) Данные и фикстуры
- Синтетические логи и run‑jsonl для export/redact.
- Пустой git репо для установки; репо с «мусорными» файлами для legacy проверки.
- Заглушки data templates (`plans_2026.csv` etc.) при необходимости.
